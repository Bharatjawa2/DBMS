CREATE TABLE STUDENT(
STU_ID INT PRIMARY KEY,
STU_NAME VARCHAR(255),
MARKS INT,
SECTION CHAR(5)
);

- Inserting data into the STUDENT table
INSERT INTO STUDENT(STU_ID, STU_NAME, MARKS, SECTION) VALUES (1, 'A', 83, 'A');
INSERT INTO STUDENT(STU_ID, STU_NAME, MARKS, SECTION) VALUES (2, 'B', 42, 'B');
INSERT INTO STUDENT(STU_ID, STU_NAME, MARKS, SECTION) VALUES (3, 'C', 56, 'A');
INSERT INTO STUDENT(STU_ID, STU_NAME, MARKS, SECTION) VALUES (4, 'D', 43, 'A');
INSERT INTO STUDENT(STU_ID, STU_NAME, MARKS, SECTION) VALUES (5, 'E', 91, 'B');

- Simple SELECT query
SELECT * FROM STUDENT;

- Queries on the STUDENT table
SELECT STU_NAME FROM STUDENT WHERE SECTION='A';
SELECT COUNT(*) FROM STUDENT GROUP BY SECTION;

- Incorrect GROUP BY expression
-- SELECT STU_NAME, COUNT(*) FROM STUDENT GROUP BY SECTION; -- This will cause an error

- Aggregate functions with GROUP BY
SELECT MIN(MARKS) FROM STUDENT GROUP BY SECTION;
SELECT SECTION, MAX(MARKS) FROM STUDENT GROUP BY SECTION;
SELECT SECTION, AVG(MARKS) FROM STUDENT GROUP BY SECTION;
SELECT SECTION, SUM(MARKS) FROM STUDENT GROUP BY SECTION;
SELECT SECTION FROM STUDENT GROUP BY SECTION HAVING AVG(MARKS) > 65;
-- SELECT MAX(SUM(MARKS)) FROM STUDENT GROUP BY SECTION; -- This will cause an error
SELECT SECTION FROM STUDENT GROUP BY SECTION HAVING SUM(MARKS) = (
SELECT MAX(SUM(MARKS)) FROM STUDENT GROUP BY SECTION
);

- Alter table to add ADDRESS column
ALTER TABLE STUDENT ADD (ADDRESS VARCHAR2(255));

- Updating ADDRESS column
UPDATE STUDENT SET ADDRESS = 'NOIDA' WHERE STU_ID = 1;
UPDATE STUDENT SET ADDRESS = 'NOIDA' WHERE STU_ID = 2;
UPDATE STUDENT SET ADDRESS = 'LUCKNOW' WHERE STU_ID = 3;
UPDATE STUDENT SET ADDRESS = 'LUCKNOW' WHERE STU_ID = 4;
UPDATE STUDENT SET ADDRESS = 'LUCKNOW' WHERE STU_ID = 5;

- Corrected Query 1: Marks Greater than Average Marks per Section
SELECT S1.MARKS FROM STUDENT S1
JOIN (
SELECT SECTION, AVG(MARKS) AS AVG_MARKS
FROM STUDENT
GROUP BY SECTION
) S2 ON S1.SECTION = S2.SECTION
WHERE S1.MARKS > S2.AVG_MARKS;

- Corrected Query 2: Section, Address, and Count of People with Same Address Grouped by Section
SELECT SECTION, ADDRESS, COUNT(*) AS PEOPLE_COUNT FROM STUDENT GROUP BY SECTION, ADDRESS;

SELECT SECTION,AVG(MARKS) FROM STUDENT GROUP BY SECTION HAVING AVG(MARKS)>(SELECT AVG(MARKS) FROM STUDENT);
SELECT SECTION,MAX(MARKS) FROM STUDENT GROUP BY SECTION;
SELECT STU_NAME FROM STUDENT WHERE ADDRESS='NOIDA' AND MARKS=(SELECT MAX(MARKS) FROM STUDENT WHERE ADDRESS='NOIDA');
SELECT AVG(MARKS) FROM STUDENT WHERE ADDRESS='NOIDA';
